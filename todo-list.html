<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Todo — Minimal, Fast, Beautiful</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg: #0b0f14;
        --card: #121822;
        --card-2: #0f141c;
        --muted: #9aa5b1;
        --text: #e6edf3;
        --pri: #7c54ff;
        --pri-2: #9c82ff;
        --accent: #22c55e;
        --danger: #ef4444;
        --ring: 0 0 0 3px rgba(124, 84, 255, 0.25);
        --radius: 16px;
        --shadow: 0 10px 30px rgba(0, 0, 0, 0.35), 0 2px 6px rgba(0, 0, 0, 0.25);
      }

      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto,
          "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji",
          "Segoe UI Emoji";
        background: radial-gradient(
            1200px 800px at 80% -10%,
            rgba(124, 84, 255, 0.15),
            transparent 55%
          ),
          radial-gradient(
            1000px 800px at -10% 110%,
            rgba(34, 197, 94, 0.12),
            transparent 55%
          ),
          var(--bg);
        color: var(--text);
        display: grid;
        place-items: center;
        padding: 32px 16px;
      }

      .app {
        width: 100%;
        max-width: 900px;
        background: linear-gradient(180deg, var(--card), var(--card-2));
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        overflow: clip;
      }

      header {
        padding: 28px 28px 18px;
        display: grid;
        gap: 16px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        background: linear-gradient(
          180deg,
          rgba(124, 84, 255, 0.08),
          transparent 40%
        );
      }

      .title {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .logo {
        width: 36px;
        height: 36px;
        border-radius: 10px;
        background: conic-gradient(
          from 180deg,
          var(--pri),
          var(--accent),
          var(--pri)
        );
        filter: saturate(120%);
        box-shadow: 0 6px 20px rgba(124, 84, 255, 0.35);
      }
      h1 {
        font-size: 20px;
        margin: 0;
        letter-spacing: 0.3px;
      }

      .add {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 10px;
      }
      .input {
        position: relative;
      }
      .input input {
        width: 100%;
        height: 48px;
        background: rgba(255, 255, 255, 0.04);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 12px;
        padding: 0 14px 0 44px;
        color: var(--text);
        outline: none;
        transition: border 0.2s, box-shadow 0.2s, background 0.2s;
      }
      .input input:focus {
        border-color: var(--pri-2);
        box-shadow: var(--ring);
        background: rgba(255, 255, 255, 0.06);
      }
      .input .icon {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        opacity: 0.8;
      }
      .btn {
        height: 48px;
        padding: 0 16px;
        background: linear-gradient(180deg, var(--pri), var(--pri-2));
        color: #fff;
        border: none;
        border-radius: 12px;
        font-weight: 600;
        letter-spacing: 0.2px;
        cursor: pointer;
        transition: transform 0.06s ease, filter 0.2s ease;
      }
      .btn:active {
        transform: translateY(1px);
      }
      .btn:focus-visible {
        box-shadow: var(--ring);
      }
      .btn.secondary {
        background: rgba(255, 255, 255, 0.06);
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.08);
        font-weight: 500;
      }

      /* Toolbar */
      .toolbar {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        align-items: center;
        justify-content: space-between;
        padding: 14px 28px;
        background: rgba(0, 0, 0, 0.15);
        border-bottom: 1px solid rgba(255, 255, 255, 0.06);
      }
      .filters,
      .bulk {
        display: flex;
        gap: 8px;
        align-items: center;
      }
      .chip {
        padding: 8px 12px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 999px;
        font-size: 13px;
        cursor: pointer;
        user-select: none;
      }
      .chip[aria-pressed="true"] {
        background: rgba(124, 84, 255, 0.18);
        border-color: rgba(124, 84, 255, 0.45);
        box-shadow: inset 0 0 0 1px rgba(124, 84, 255, 0.25);
      }

      /* List */
      .list {
        padding: 8px;
        max-height: 60vh;
        overflow: auto;
      }
      .empty {
        display: grid;
        place-items: center;
        text-align: center;
        padding: 48px 16px;
        color: var(--muted);
      }

      .item {
        display: grid;
        grid-template-columns: auto 1fr auto;
        align-items: center;
        gap: 12px;
        margin: 8px;
        padding: 12px 14px;
        background: rgba(255, 255, 255, 0.04);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 14px;
        transition: background 0.2s, border 0.2s, transform 0.15s ease;
      }
      .item[draggable="true"] {
        cursor: grab;
      }
      .item.dragging {
        opacity: 0.6;
        transform: scale(0.98);
      }
      .item:hover {
        background: rgba(255, 255, 255, 0.06);
      }

      .check {
        width: 22px;
        height: 22px;
        border-radius: 6px;
        border: 1.5px solid rgba(255, 255, 255, 0.25);
        display: grid;
        place-items: center;
        cursor: pointer;
        transition: background 0.2s, border 0.2s;
      }
      .check[data-checked="true"] {
        background: var(--accent);
        border-color: var(--accent);
      }
      .check svg {
        display: none;
      }
      .check[data-checked="true"] svg {
        display: block;
      }

      .label {
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .label input[type="text"] {
        width: 100%;
        background: transparent;
        border: none;
        outline: none;
        color: var(--text);
        font-size: 15px;
        padding: 8px 4px;
        border-radius: 8px;
      }
      .label input[type="text"]:focus {
        box-shadow: var(--ring);
      }
      .label .done {
        text-decoration: line-through;
        color: var(--muted);
      }

      .actions {
        display: flex;
        gap: 8px;
      }
      .iconbtn {
        width: 36px;
        height: 36px;
        display: grid;
        place-items: center;
        border-radius: 10px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.08);
        cursor: pointer;
        transition: background 0.2s, transform 0.08s ease;
      }
      .iconbtn:hover {
        background: rgba(255, 255, 255, 0.08);
      }
      .iconbtn:active {
        transform: translateY(1px);
      }
      .iconbtn.danger {
        border-color: rgba(239, 68, 68, 0.35);
      }

      footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 14px 20px;
        color: var(--muted);
        border-top: 1px solid rgba(255, 255, 255, 0.06);
      }
      .count {
        font-variant-numeric: tabular-nums;
      }

      /* Utilities */
      .visually-hidden {
        position: absolute !important;
        height: 1px;
        width: 1px;
        overflow: hidden;
        clip: rect(1px, 1px, 1px, 1px);
        white-space: nowrap;
      }

      @media (max-width: 600px) {
        header {
          padding: 20px 16px 12px;
        }
        .toolbar {
          padding: 12px 16px;
        }
        .item {
          margin: 8px 6px;
          padding: 10px 12px;
        }
      }
    </style>
  </head>
  <body>
    <div class="app" role="application" aria-label="Todo app">
      <header>
        <div class="title">
          <div class="logo" aria-hidden="true"></div>
          <h1>Todo</h1>
        </div>
        <form class="add" id="addForm" autocomplete="off">
          <div class="input">
            <span class="icon" aria-hidden="true">
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M21 21l-4.35-4.35"
                  stroke="currentColor"
                  stroke-width="1.6"
                  stroke-linecap="round"
                />
                <circle
                  cx="11"
                  cy="11"
                  r="6.5"
                  stroke="currentColor"
                  stroke-width="1.6"
                />
              </svg>
            </span>
            <input
              id="newTodo"
              name="title"
              placeholder="Add a task… (press Enter)"
              aria-label="Add a task"
              required
            />
          </div>
          <button class="btn" type="submit" aria-label="Add task">Add</button>
        </form>
      </header>

      <div class="toolbar" role="toolbar" aria-label="Filters and bulk actions">
        <div class="filters" id="filters">
          <button class="chip" data-filter="all" aria-pressed="true">
            All
          </button>
          <button class="chip" data-filter="active" aria-pressed="false">
            Active
          </button>
          <button class="chip" data-filter="completed" aria-pressed="false">
            Completed
          </button>
        </div>
        <div class="bulk">
          <button class="chip" id="toggleAll">Toggle all</button>
          <button class="chip" id="clearCompleted">Clear completed</button>
        </div>
      </div>

      <main class="list" id="list" aria-live="polite"></main>

      <div class="empty" id="empty" hidden>
        <div>
          <svg
            width="56"
            height="56"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            aria-hidden="true"
          >
            <rect
              x="3"
              y="4"
              width="18"
              height="16"
              rx="3"
              stroke="currentColor"
              opacity=".35"
            />
            <path d="M7 9h10M7 13h6" stroke="currentColor" opacity=".35" />
          </svg>
          <p>No tasks yet. Add your first above ✨</p>
        </div>
      </div>

      <footer>
        <span class="count" id="count" aria-live="polite">0 items</span>
        <span>Drag to reorder • Double‑click to edit</span>
      </footer>
    </div>

    <template id="itemTemplate">
      <div class="item" draggable="true">
        <button class="check" aria-label="Toggle done" data-checked="false">
          <svg
            width="14"
            height="14"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M5 12.5l4 4L19 7"
              stroke="#fff"
              stroke-width="2.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </button>
        <label class="label">
          <input type="text" value="" aria-label="Task title" />
        </label>
        <div class="actions">
          <button
            class="iconbtn"
            data-action="edit"
            title="Edit (or double‑click text)"
          >
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z"
                fill="currentColor"
              />
            </svg>
          </button>
          <button class="iconbtn danger" data-action="delete" title="Delete">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M6 7h12m-1 0l-1 12a2 2 0 0 1-2 2H10a2 2 0 0 1-2-2L7 7m3 0V5a2 2 0 0 1 2-2h0a2 2 0 0 1 2 2v2"
                stroke="currentColor"
                stroke-width="1.6"
                stroke-linecap="round"
              />
            </svg>
          </button>
        </div>
      </div>
    </template>

    <script>
      const $$ = (sel, ctx = document) => Array.from(ctx.querySelectorAll(sel));
      const $ = (sel, ctx = document) => ctx.querySelector(sel);

      const STORAGE_KEY = "todo-items-v1";

      const state = {
        items: /** @type {{id:string, title:string, done:boolean}[]} */ ([]),
        filter: "all", // all | active | completed
      };

      // Load
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (raw) state.items = JSON.parse(raw);
      } catch {}

      const els = {
        form: $("#addForm"),
        input: $("#newTodo"),
        list: $("#list"),
        empty: $("#empty"),
        count: $("#count"),
        filters: $("#filters"),
        clearCompleted: $("#clearCompleted"),
        toggleAll: $("#toggleAll"),
        tpl: $("#itemTemplate"),
      };

      function save() {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(state.items));
      }

      function uid() {
        return Math.random().toString(36).slice(2, 9);
      }

      function setFilter(name) {
        state.filter = name;
        $$(".chip", els.filters).forEach((chip) =>
          chip.setAttribute(
            "aria-pressed",
            String(chip.dataset.filter === name)
          )
        );
        render();
      }

      function filtered() {
        if (state.filter === "active")
          return state.items.filter((i) => !i.done);
        if (state.filter === "completed")
          return state.items.filter((i) => i.done);
        return state.items;
      }

      function render() {
        els.list.innerHTML = "";
        const items = filtered();

        els.empty.hidden = items.length !== 0;
        items.forEach(addItemEl);

        const remaining = state.items.filter((i) => !i.done).length;
        els.count.textContent = `${remaining} item${
          remaining === 1 ? "" : "s"
        } left`;
      }

      function addItem(title) {
        state.items.unshift({ id: uid(), title, done: false });
        save();
        render();
      }

      function updateItem(id, partial) {
        const idx = state.items.findIndex((i) => i.id === id);
        if (idx !== -1) {
          state.items[idx] = { ...state.items[idx], ...partial };
          save();
          render();
        }
      }

      function removeItem(id) {
        state.items = state.items.filter((i) => i.id !== id);
        save();
        render();
      }

      function addItemEl(data) {
        const node = els.tpl.content.firstElementChild.cloneNode(true);
        node.dataset.id = data.id;

        const check = $(".check", node);
        const input = $('input[type="text"]', node);

        check.dataset.checked = String(!!data.done);
        if (data.done) input.classList.add("done");

        input.value = data.title;

        // Toggle done
        check.addEventListener("click", () =>
          updateItem(data.id, { done: !data.done })
        );

        // Inline edit (double click)
        input.addEventListener("dblclick", () => input.focus());
        input.addEventListener("blur", () => {
          const title = input.value.trim();
          if (!title) {
            removeItem(data.id);
            return;
          }
          if (title !== data.title) updateItem(data.id, { title });
        });
        input.addEventListener("keydown", (e) => {
          if (e.key === "Enter") input.blur();
          if (e.key === "Escape") {
            input.value = data.title;
            input.blur();
          }
        });

        // Action buttons
        node.addEventListener("click", (e) => {
          const btn = e.target.closest("button");
          if (!btn) return;
          if (btn.dataset.action === "delete") removeItem(data.id);
          if (btn.dataset.action === "edit") input.focus();
        });

        // Drag & drop
        node.addEventListener("dragstart", () => {
          node.classList.add("dragging");
          node.style.opacity = ".6";
        });
        node.addEventListener("dragend", () => {
          node.classList.remove("dragging");
          node.style.opacity = "";
          persistOrder();
        });

        els.list.addEventListener("dragover", (e) => {
          e.preventDefault();
          const after = getDragAfterElement(els.list, e.clientY);
          const dragging = $(".item.dragging");
          if (!dragging) return;
          if (after == null) {
            els.list.appendChild(dragging);
          } else {
            els.list.insertBefore(dragging, after);
          }
        });

        els.list.appendChild(node);
      }

      function getDragAfterElement(container, y) {
        const elsArr = [...$$(".item:not(.dragging)", container)];
        return elsArr.reduce(
          (closest, child) => {
            const box = child.getBoundingClientRect();
            const offset = y - box.top - box.height / 2;
            if (offset < 0 && offset > closest.offset) {
              return { offset, element: child };
            } else {
              return closest;
            }
          },
          { offset: Number.NEGATIVE_INFINITY }
        ).element;
      }

      function persistOrder() {
        const orderIds = $$(".item", els.list).map((el) => el.dataset.id);
        state.items.sort(
          (a, b) => orderIds.indexOf(a.id) - orderIds.indexOf(b.id)
        );
        save();
      }

      // Events
      els.form.addEventListener("submit", (e) => {
        e.preventDefault();
        const title = els.input.value.trim();
        if (!title) return;
        addItem(title);
        els.input.value = "";
        els.input.focus();
      });

      els.filters.addEventListener("click", (e) => {
        const btn = e.target.closest("[data-filter]");
        if (!btn) return;
        setFilter(btn.dataset.filter);
      });

      els.clearCompleted.addEventListener("click", () => {
        state.items = state.items.filter((i) => !i.done);
        save();
        render();
      });

      els.toggleAll.addEventListener("click", () => {
        const allDone = state.items.every((i) => i.done);
        state.items = state.items.map((i) => ({ ...i, done: !allDone }));
        save();
        render();
      });

      // Keyboard delete support
      document.addEventListener("keydown", (e) => {
        if (e.key === "Delete") {
          const active = document.activeElement;
          const item = active && active.closest && active.closest(".item");
          if (item) removeItem(item.dataset.id);
        }
      });

      // Start
      render();
    </script>
  </body>
</html>
